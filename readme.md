# ConsoleAlarm64 - Консольный будильник на C#

Документация по консольному будильнику (ConsoleAlarm64). 


ConsoleAlarm64 - это программа для ОС Windows, которая используется в качестве
простого будильника и имеет консольный интерфейс. Включает в себя большинство
из базовых функций будильника, это:

 1. Установка будильника на нужную дату, время.
 2. Удаление определенного будильника (ранее созданного).
 3. Просмотр списка будильников.
 4. Редактировние будильника (ранее созданного).
 5. Выбор типа сигнала, возможность установки собственных звуков при срабатывании.
 6. Консольный ввод команд, псевдографика
 - И многое другое...

В этой документации вы увидите многие тонкости в работе с данной программой, а также
некоторые способы взаимодействия, некоторые механизмы работы и возможности данной программы.


Установка и запуск
--------------------

 1. Установить .NET Framework 4.5 (при необходимости).
 2. Скачать содержимое репозитория при помощи 'Clone Or Download'.
 3. Распаковать содержимое скачанного архива.
 4. Запустить файл ConsoleAlarm64.exe.




Системные требования
----------------------

- .NET Framework 4.5
- 60MB Ram
- 200Kb Free disk space


Консольный ввод команд
-----------------------

Программа основывается на работе с командами, которые пользователь отправляет в программу. Команды вводятся
в специально отведенную для этого строку, затем по нажатию на [Enter], отправляются. Каждая команда состоит из:
- ссылки (команды)
- аргументов команды

Команда поделена на ссылки и аргументы при помощи пробела, то есть схема вида `command arg arg1 arg2`, отправленная в 
консоль, значит следующее:
- command (ссылка)
- arg, arg1, arg2 (аргументы команды)

Системные команды начинаютс с символа `~`, не могут быть выполнены при обычном вводе команды.



Файл конфигурации.
------------------

Программа использует многочисленные конфигурации, которые доступны к редактированию пользователям, 
дабы сделать программу более открытой и позволить расширить ее многие возможности. Именно для этого 
существует данная система.

Файл конфигурации имеет имя  `config.txt`. Программа по-умолчанию заблокирована для изменения конфигураций,
однако когда данный файл будет создан в папке с программой, она попытается прочитать его и применить параметры.

В файле конфигурации должна находится строка, которая имеет вид: `?arg1=par1&arg2=par2` ...
При такой системе, каждому аргументу соответствует свой параметр. Это дает возможность для элементарной настройки.

Программа имеет несколько параметров для конфигурации. Практически в каждой версии они разные, поэтому узнать актуальные
параметры вы сможете при помощи команды `cfg par`.



Хранение данных о будильниках
-------------------------
 Программа использует текстовый файл для хранения будильников и взаимодействия
 с ними. Путь до файла можно изменить в настройках конфигурации и он может быть
 любым по формату и весу. Изначално этот файл обозначается как alarms.txt.
 Важно то, чтобы файл имел права для чтения и записи содержимого.
 
 Во время запуска программы без данного файла, будет срабатвать триггер "первый запуск",
 появится приветственное сообщение и краткая инструкция по пользованию прграммой.
 Если файла не существует при обращении к нему, он будет создан автоматически.
 
 Информация о каждом будильнике хранится в каждой новой строке файла, нумерация строк
 используется для удаления/редактирования нужного будильника программой. Это используется
 многими командами.
 При чтении списка будильников, важно чтобы аргументы были указаны правильно. 
 Разделителем для данных служит обычный, одинарный пробел.
 
 
 Информация о будильнике имеет следующую структуру:
 `1 08.03.2019 0:10 0JHRg9C00LjQu9GM0L3QuNC6IDEyMw== 1`
 
 Слева направа:
 
 1. Статус будильника (1 или 0). Если 0, то будет проинорирован при чтении файла.
 2. Дата в формате ДД.ММ.ГГГГ ЧЧ:ММ
 3. Имя будильника (зашифровано в Base64), будет раскодировано при чтении
 4. Тип сигнала будильника.



Запуск с аргументами запуска
------------------------------
 Программа поддерживает возможность запуска с некоторыми аргументами.
 Стандартные аргументы запуска разделяются символом пробела, и выглядят:
 `ConsoleAlarm64.exe Агрумент1 Аргумент2 Аргумент3`...
 
 Консольный будильник использует первый аргумент как основное тело команды.
 Все последующие аргументы используются определенной (уже выбранной) командой.


 1. Агрумент "Alarm" вызывает срабатывание будильника. Вызывается программой
 в процессе работы или может быть вызван пользователем. 
 
 Вторым аргументом может передаваться подробная информация о будильнике:
(где звездочка - применяется во время запуска)
 - 1 ID в файле;
 - 2 ID в базе;
 - 3 Состояние;
 - 4,5 Время и дата срабатывания*;
 - 6 Его название* (в Base64);
 - 7 Тип*;
 Данные передаются в формате: 1_2_3_4_5_6_7 (разделитель - '_')
 
 2. Аргумент "Restart" передает сообщение о том, что программа была перезапущена.
 Слушит для оповещения пользователя о возникшей проблеме.
 
 3. Аргумент "Cmd" может применяться для выполнения каких-либо команд во время запуска программы, например: 
 для автоматической настройки или установки будильника на нужное время или в каких-либо других служебных целях.
 Вторым аргументом должен передаваться какой-либо набор команд (без ограничений).
 Важно понимать, что любые пробелы заменяются на символ "_", а сами команды разделяются при помощи ":".
 Таким образом, формат набора команд будет таким: команда1:команда2:команда3 и т.д..
 
4. Аргумент "Cfg" применяется для настройки временной конфигурации. В этом случае полностью игнорируется настройки,
 сохраненнные в файле конфигурации. Вторым аргументом используется сама строка конфигурации, например может
 передаваться такой вариант: `Cfg ?log=1&file=alarm.txt`.

 
 
Триггеры
---------

С помощью триггеров можно добавить выполнение команд для каких-либо операций. Триггеры помещаются в папку `\triggers`,
представляют из себя обычные .TXT файлы. Например, триггер start должен иметь имя `start.txt` (полное - `\triggers\start.txt`).

В файл триггера помещаются команды. Каждая команда начинается с новой строки. Когда триггер срабатывает, он поочередно
выполняет команды, начиная с самой первой строчкой файла. Задержка на выполнение каждой последующей команды - 100МС.
Команды выполняются в синхронном режиме.

Вызвать нужный триггер можно командой `^ trigger_name`. В этом случае будет вызван файл `trigger_name`.
Следует помнить, что триггеры по-умолчанию отключены в настройках программы. Нужно их включить, воспользовавшись
конфигурационным файлом.

В программе есть несколько стандартных триггеров, которые каждый раз вызываются в определенный момент, 
это следующие триггеры:

1. awake      —  В самом начале программы
2. launch     —  После загрузки программы
3. clock      —  Каждый тик времени
4. signal     —  При срабатывании будильника
5. stop       —  При выходе из программы
6. onreload   -  При перезагрузке программы
